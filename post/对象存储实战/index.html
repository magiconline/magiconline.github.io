<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>对象存储实战 - 魔法张的Blog</title><meta name=description content="抖音背后的存储 存储需求 上传视频 存储原视频 转码，存储不同码率视频 抽帧，存储图片，审核 推荐服务 下载视频、图片 需要易用、海量、便宜的存储。
为什么对象存储 存储系统分类 单机存储：文件系统，kv存储 单机数据库：关系型数据库、非关系型数据库 分布式数据库：关系型数据库、非关系型数据库 分布式存储：分布式文件系统、对象存储 存储系统对比 存储备选 海量支持 适合数据类型 单机存储 No 单机文件、KV 单机数据库 No 少量结构化、半结构化数据 分布式数据库 Yes 大量结构化、半结构化数据 分布式存储 Yes 大数据计算中间结果、视频、图片等 分布式存储选型 海量 易用 便宜 分布式文件系统HDFS 支持PB、EB海量存储；文件数量受Name Node 限制 伪Posix文件接口，开发复杂；非云原生，搭建维护麻烦；视频、图片相关生态接入复杂 使用普通X86服务器，成本低 对象存储 支持EB海量存储；对象数量无限制 Restful 接口，开发简单；云原生，按需申请使用；视频、图片相关生态丰富 使用普通X86服务器；具备冷热数据分级存储能力，成本更低 适用场景 静态文件
视频 图片 文本 安装包 备份 前端js文件 对象存储怎么用 申请Bucket -> 业务理论逻辑开发 -> 上线测试
Restful 接口 PUT 参数: Bucket, key, 对象内容 返回: 成功/失败 GET： 参数：Bucket，key 返回：对象内容 HEAD： 参数：Bucket，key 返回：对象元信息 DELETE： 参数：Bucket，key 返回：成功/失败 TOS字节内部实践 开发一个对象存储 容量型 代表业务：片源、转码 特点：容量大、吞吐大、高持久度 挑战：可扩展性、成本、持久度 QPS型 代表业务：抽帧 特点：QPS高 挑战：可扩展性 可扩展性 - Partition 分布式存储 = 分布式 + 单机存储"><meta name=author content><link rel="preload stylesheet" as=style href=https://magiconline.github.io/app.min.css><link rel="preload stylesheet" as=style href=https://magiconline.github.io/an-old-hope.min.css><script defer src=https://magiconline.github.io/highlight.min.js onload=hljs.initHighlightingOnLoad()></script>
<link rel=preload as=image href=https://magiconline.github.io/theme.png><link rel=preload as=image href=https://magiconline.github.io/github.svg><link rel=icon href=https://magiconline.github.io/favicon.ico><link rel=apple-touch-icon href=https://magiconline.github.io/apple-touch-icon.png><meta name=generator content="Hugo 0.100.2"><meta property="og:title" content="对象存储实战"><meta property="og:description" content="抖音背后的存储 存储需求 上传视频 存储原视频 转码，存储不同码率视频 抽帧，存储图片，审核 推荐服务 下载视频、图片 需要易用、海量、便宜的存储。
为什么对象存储 存储系统分类 单机存储：文件系统，kv存储 单机数据库：关系型数据库、非关系型数据库 分布式数据库：关系型数据库、非关系型数据库 分布式存储：分布式文件系统、对象存储 存储系统对比 存储备选 海量支持 适合数据类型 单机存储 No 单机文件、KV 单机数据库 No 少量结构化、半结构化数据 分布式数据库 Yes 大量结构化、半结构化数据 分布式存储 Yes 大数据计算中间结果、视频、图片等 分布式存储选型 海量 易用 便宜 分布式文件系统HDFS 支持PB、EB海量存储；文件数量受Name Node 限制 伪Posix文件接口，开发复杂；非云原生，搭建维护麻烦；视频、图片相关生态接入复杂 使用普通X86服务器，成本低 对象存储 支持EB海量存储；对象数量无限制 Restful 接口，开发简单；云原生，按需申请使用；视频、图片相关生态丰富 使用普通X86服务器；具备冷热数据分级存储能力，成本更低 适用场景 静态文件
视频 图片 文本 安装包 备份 前端js文件 对象存储怎么用 申请Bucket -> 业务理论逻辑开发 -> 上线测试
Restful 接口 PUT 参数: Bucket, key, 对象内容 返回: 成功/失败 GET： 参数：Bucket，key 返回：对象内容 HEAD： 参数：Bucket，key 返回：对象元信息 DELETE： 参数：Bucket，key 返回：成功/失败 TOS字节内部实践 开发一个对象存储 容量型 代表业务：片源、转码 特点：容量大、吞吐大、高持久度 挑战：可扩展性、成本、持久度 QPS型 代表业务：抽帧 特点：QPS高 挑战：可扩展性 可扩展性 - Partition 分布式存储 = 分布式 + 单机存储"><meta property="og:type" content="article"><meta property="og:url" content="https://magiconline.github.io/post/%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E5%AE%9E%E6%88%98/"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-06-05T15:45:02+08:00"><meta property="article:modified_time" content="2022-06-05T15:45:02+08:00"><meta itemprop=name content="对象存储实战"><meta itemprop=description content="抖音背后的存储 存储需求 上传视频 存储原视频 转码，存储不同码率视频 抽帧，存储图片，审核 推荐服务 下载视频、图片 需要易用、海量、便宜的存储。
为什么对象存储 存储系统分类 单机存储：文件系统，kv存储 单机数据库：关系型数据库、非关系型数据库 分布式数据库：关系型数据库、非关系型数据库 分布式存储：分布式文件系统、对象存储 存储系统对比 存储备选 海量支持 适合数据类型 单机存储 No 单机文件、KV 单机数据库 No 少量结构化、半结构化数据 分布式数据库 Yes 大量结构化、半结构化数据 分布式存储 Yes 大数据计算中间结果、视频、图片等 分布式存储选型 海量 易用 便宜 分布式文件系统HDFS 支持PB、EB海量存储；文件数量受Name Node 限制 伪Posix文件接口，开发复杂；非云原生，搭建维护麻烦；视频、图片相关生态接入复杂 使用普通X86服务器，成本低 对象存储 支持EB海量存储；对象数量无限制 Restful 接口，开发简单；云原生，按需申请使用；视频、图片相关生态丰富 使用普通X86服务器；具备冷热数据分级存储能力，成本更低 适用场景 静态文件
视频 图片 文本 安装包 备份 前端js文件 对象存储怎么用 申请Bucket -> 业务理论逻辑开发 -> 上线测试
Restful 接口 PUT 参数: Bucket, key, 对象内容 返回: 成功/失败 GET： 参数：Bucket，key 返回：对象内容 HEAD： 参数：Bucket，key 返回：对象元信息 DELETE： 参数：Bucket，key 返回：成功/失败 TOS字节内部实践 开发一个对象存储 容量型 代表业务：片源、转码 特点：容量大、吞吐大、高持久度 挑战：可扩展性、成本、持久度 QPS型 代表业务：抽帧 特点：QPS高 挑战：可扩展性 可扩展性 - Partition 分布式存储 = 分布式 + 单机存储"><meta itemprop=datePublished content="2022-06-05T15:45:02+08:00"><meta itemprop=dateModified content="2022-06-05T15:45:02+08:00"><meta itemprop=wordCount content="114"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="对象存储实战"><meta name=twitter:description content="抖音背后的存储 存储需求 上传视频 存储原视频 转码，存储不同码率视频 抽帧，存储图片，审核 推荐服务 下载视频、图片 需要易用、海量、便宜的存储。
为什么对象存储 存储系统分类 单机存储：文件系统，kv存储 单机数据库：关系型数据库、非关系型数据库 分布式数据库：关系型数据库、非关系型数据库 分布式存储：分布式文件系统、对象存储 存储系统对比 存储备选 海量支持 适合数据类型 单机存储 No 单机文件、KV 单机数据库 No 少量结构化、半结构化数据 分布式数据库 Yes 大量结构化、半结构化数据 分布式存储 Yes 大数据计算中间结果、视频、图片等 分布式存储选型 海量 易用 便宜 分布式文件系统HDFS 支持PB、EB海量存储；文件数量受Name Node 限制 伪Posix文件接口，开发复杂；非云原生，搭建维护麻烦；视频、图片相关生态接入复杂 使用普通X86服务器，成本低 对象存储 支持EB海量存储；对象数量无限制 Restful 接口，开发简单；云原生，按需申请使用；视频、图片相关生态丰富 使用普通X86服务器；具备冷热数据分级存储能力，成本更低 适用场景 静态文件
视频 图片 文本 安装包 备份 前端js文件 对象存储怎么用 申请Bucket -> 业务理论逻辑开发 -> 上线测试
Restful 接口 PUT 参数: Bucket, key, 对象内容 返回: 成功/失败 GET： 参数：Bucket，key 返回：对象内容 HEAD： 参数：Bucket，key 返回：对象元信息 DELETE： 参数：Bucket，key 返回：成功/失败 TOS字节内部实践 开发一个对象存储 容量型 代表业务：片源、转码 特点：容量大、吞吐大、高持久度 挑战：可扩展性、成本、持久度 QPS型 代表业务：抽帧 特点：QPS高 挑战：可扩展性 可扩展性 - Partition 分布式存储 = 分布式 + 单机存储"></head><body class=not-ready data-menu=true><header class=header><p class=logo><a class=site-name href=https://magiconline.github.io/>魔法张的Blog</a><a class=btn-dark></a></p><script>let bodyClx=document.body.classList,btnDark=document.querySelector('.btn-dark'),sysDark=window.matchMedia('(prefers-color-scheme: dark)'),darkVal=localStorage.getItem('dark'),setDark=e=>{bodyClx[e?'add':'remove']('dark'),localStorage.setItem('dark',e?'yes':'no')};setDark(darkVal?darkVal==='yes':sysDark.matches),requestAnimationFrame(()=>bodyClx.remove('not-ready')),btnDark.addEventListener('click',()=>setDark(!bodyClx.contains('dark'))),sysDark.addEventListener('change',e=>setDark(e.matches))</script><nav class=menu><a href=/about/>关于</a></nav><nav class=social><a class=github style=--url:url(./github.svg) href=https://github.com/magiconline target=_blank></a></nav></header><main class=main><article class=post-single><header class=post-title><p><time>Jun 5, 2022</time></p><h1>对象存储实战</h1></header><section class=post-content><h1 id=抖音背后的存储>抖音背后的存储</h1><h2 id=存储需求>存储需求</h2><ol><li>上传视频</li><li>存储原视频</li><li><ol><li>转码，存储不同码率视频</li><li>抽帧，存储图片，审核</li></ol></li><li>推荐服务</li><li>下载视频、图片</li></ol><p>需要易用、海量、便宜的存储。</p><h1 id=为什么对象存储>为什么对象存储</h1><h2 id=存储系统分类>存储系统分类</h2><ol><li>单机存储：文件系统，kv存储</li><li>单机数据库：关系型数据库、非关系型数据库</li><li>分布式数据库：关系型数据库、非关系型数据库</li><li>分布式存储：分布式文件系统、对象存储</li></ol><h2 id=存储系统对比>存储系统对比</h2><table><thead><tr><th>存储备选</th><th>海量支持</th><th>适合数据类型</th></tr></thead><tbody><tr><td>单机存储</td><td>No</td><td>单机文件、KV</td></tr><tr><td>单机数据库</td><td>No</td><td>少量结构化、半结构化数据</td></tr><tr><td>分布式数据库</td><td>Yes</td><td>大量结构化、半结构化数据</td></tr><tr><td>分布式存储</td><td>Yes</td><td>大数据计算中间结果、视频、图片等</td></tr></tbody></table><h2 id=分布式存储选型>分布式存储选型</h2><table><thead><tr><th></th><th>海量</th><th>易用</th><th>便宜</th></tr></thead><tbody><tr><td>分布式文件系统HDFS</td><td>支持PB、EB海量存储；文件数量受Name Node 限制</td><td>伪Posix文件接口，开发复杂；非云原生，搭建维护麻烦；视频、图片相关生态接入复杂</td><td>使用普通X86服务器，成本低</td></tr><tr><td>对象存储</td><td>支持EB海量存储；对象数量无限制</td><td>Restful 接口，开发简单；云原生，按需申请使用；视频、图片相关生态丰富</td><td>使用普通X86服务器；具备冷热数据分级存储能力，成本更低</td></tr></tbody></table><h2 id=适用场景>适用场景</h2><p>静态文件</p><ul><li>视频</li><li>图片</li><li>文本</li><li>安装包</li><li>备份</li><li>前端js文件</li></ul><h1 id=对象存储怎么用>对象存储怎么用</h1><p>申请Bucket -> 业务理论逻辑开发 -> 上线测试</p><h2 id=restful-接口>Restful 接口</h2><ul><li>PUT<ul><li>参数: Bucket, key, 对象内容</li><li>返回: 成功/失败</li></ul></li><li>GET：<ul><li>参数：Bucket，key</li><li>返回：对象内容</li></ul></li><li>HEAD：<ul><li>参数：Bucket，key</li><li>返回：对象元信息</li></ul></li><li>DELETE：<ul><li>参数：Bucket，key</li><li>返回：成功/失败</li></ul></li></ul><h1 id=tos字节内部实践>TOS字节内部实践</h1><h2 id=开发一个对象存储>开发一个对象存储</h2><ul><li>容量型<ul><li>代表业务：片源、转码</li><li>特点：容量大、吞吐大、高持久度</li><li>挑战：可扩展性、成本、持久度</li></ul></li><li>QPS型<ul><li>代表业务：抽帧</li><li>特点：QPS高</li><li>挑战：可扩展性</li></ul></li></ul><h2 id=可扩展性---partition>可扩展性 - Partition</h2><p>分布式存储 = 分布式 + 单机存储<br>分布式：计算、存储、压力均匀分布</p><h2 id=持久度---replication>持久度 - Replication</h2><p>复制：</p><ul><li>多副本</li><li>多机架</li><li>多机房</li><li>多地区</li></ul><h2 id=成本>成本</h2><p>冗余编码：可达到和多副本一样的持久度，成本更低，增加了额外的编码计算步骤。<br>冷热转换：SSD -> HDD -> 磁带、光盘</p><h2 id=高可用>高可用</h2><p>镜像灾备、拆分到多集群</p></section><nav class=post-nav><a class=prev href=https://magiconline.github.io/post/rpc%E6%A1%86%E6%9E%B6/><span>←</span><span>RPC框架</span></a>
<a class=next href=https://magiconline.github.io/post/rdbms/><span>深入理解RDBMS</span><span>→</span></a></nav></article></main><footer class=footer><p>&copy; 2022 <a href=https://magiconline.github.io/>魔法张的Blog</a></p><p>Powered by <a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>️</p><p><a href=https://github.com/nanxiaobei/hugo-paper rel=noopener target=_blank>Paper 5.1</a></p></footer></body></html>