<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>深入理解RDBMS - 魔法张的Blog</title><meta name=description content="经典案例 关系型数据库事务ACID 事务(Transaction): 是由一组SQL语句组成的一个程序执行单元 ACID： 原子性、一致性、隔离性、持久性 发展历史 前DBMS时代 人工管理、文件系统
DBMS数据模型 数据库按数据模型的特点可以分成：网状数据库、层次数据库和关系型数据库
关系型数据库的劣势是关系查询效率不够高，关系必须规范化。
关键技术 一条SQL的一生 SQL -> Parser -> optimizer -> Executor
语法解析器Parser 词法分析：获得关键字、表列名、常量、运算符、结束符 语法分析：填充一个数据结构Stmt 语义分析：检查table/name是否存在，变量是否合法 optimizer 基于规则的优化 基于代价的优化 Executor 火山模型 向量化 编译执行 存储引擎 - InnoDB In-Memory
Buffer Pool Change Buffer Adaptive Hash Index Log Buffer On-Disk
System Tablespace General Tablespace Undo Tablespace Temporary Tablespace Redo Log 事务引擎 通过Undo Log实现事务回退。 隔离性通过锁实现 读读 share lock 写写 exclusive lock 读写 share lock | exclusive lock | MVCC读写分离 持久性 事务提交前页面写盘(随机IO、写放大) WAL(write-ahead logging)，通过redo log 记录页面的变化，如果发生错误，重启后根据redo log 重做 企业实践 红包 流量大、流量突增、稳定性"><meta name=author content><link rel="preload stylesheet" as=style href=https://magiconline.github.io/app.min.css><link rel="preload stylesheet" as=style href=https://magiconline.github.io/an-old-hope.min.css><script defer src=https://magiconline.github.io/highlight.min.js onload=hljs.initHighlightingOnLoad()></script>
<link rel=preload as=image href=https://magiconline.github.io/theme.png><link rel=preload as=image href=https://magiconline.github.io/github.svg><link rel=icon href=https://magiconline.github.io/favicon.ico><link rel=apple-touch-icon href=https://magiconline.github.io/apple-touch-icon.png><meta name=generator content="Hugo 0.100.1"><meta property="og:title" content="深入理解RDBMS"><meta property="og:description" content="经典案例 关系型数据库事务ACID 事务(Transaction): 是由一组SQL语句组成的一个程序执行单元 ACID： 原子性、一致性、隔离性、持久性 发展历史 前DBMS时代 人工管理、文件系统
DBMS数据模型 数据库按数据模型的特点可以分成：网状数据库、层次数据库和关系型数据库
关系型数据库的劣势是关系查询效率不够高，关系必须规范化。
关键技术 一条SQL的一生 SQL -> Parser -> optimizer -> Executor
语法解析器Parser 词法分析：获得关键字、表列名、常量、运算符、结束符 语法分析：填充一个数据结构Stmt 语义分析：检查table/name是否存在，变量是否合法 optimizer 基于规则的优化 基于代价的优化 Executor 火山模型 向量化 编译执行 存储引擎 - InnoDB In-Memory
Buffer Pool Change Buffer Adaptive Hash Index Log Buffer On-Disk
System Tablespace General Tablespace Undo Tablespace Temporary Tablespace Redo Log 事务引擎 通过Undo Log实现事务回退。 隔离性通过锁实现 读读 share lock 写写 exclusive lock 读写 share lock | exclusive lock | MVCC读写分离 持久性 事务提交前页面写盘(随机IO、写放大) WAL(write-ahead logging)，通过redo log 记录页面的变化，如果发生错误，重启后根据redo log 重做 企业实践 红包 流量大、流量突增、稳定性"><meta property="og:type" content="article"><meta property="og:url" content="https://magiconline.github.io/post/rdbms/"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-06-04T18:41:49+08:00"><meta property="article:modified_time" content="2022-06-04T18:41:49+08:00"><meta itemprop=name content="深入理解RDBMS"><meta itemprop=description content="经典案例 关系型数据库事务ACID 事务(Transaction): 是由一组SQL语句组成的一个程序执行单元 ACID： 原子性、一致性、隔离性、持久性 发展历史 前DBMS时代 人工管理、文件系统
DBMS数据模型 数据库按数据模型的特点可以分成：网状数据库、层次数据库和关系型数据库
关系型数据库的劣势是关系查询效率不够高，关系必须规范化。
关键技术 一条SQL的一生 SQL -> Parser -> optimizer -> Executor
语法解析器Parser 词法分析：获得关键字、表列名、常量、运算符、结束符 语法分析：填充一个数据结构Stmt 语义分析：检查table/name是否存在，变量是否合法 optimizer 基于规则的优化 基于代价的优化 Executor 火山模型 向量化 编译执行 存储引擎 - InnoDB In-Memory
Buffer Pool Change Buffer Adaptive Hash Index Log Buffer On-Disk
System Tablespace General Tablespace Undo Tablespace Temporary Tablespace Redo Log 事务引擎 通过Undo Log实现事务回退。 隔离性通过锁实现 读读 share lock 写写 exclusive lock 读写 share lock | exclusive lock | MVCC读写分离 持久性 事务提交前页面写盘(随机IO、写放大) WAL(write-ahead logging)，通过redo log 记录页面的变化，如果发生错误，重启后根据redo log 重做 企业实践 红包 流量大、流量突增、稳定性"><meta itemprop=datePublished content="2022-06-04T18:41:49+08:00"><meta itemprop=dateModified content="2022-06-04T18:41:49+08:00"><meta itemprop=wordCount content="98"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="深入理解RDBMS"><meta name=twitter:description content="经典案例 关系型数据库事务ACID 事务(Transaction): 是由一组SQL语句组成的一个程序执行单元 ACID： 原子性、一致性、隔离性、持久性 发展历史 前DBMS时代 人工管理、文件系统
DBMS数据模型 数据库按数据模型的特点可以分成：网状数据库、层次数据库和关系型数据库
关系型数据库的劣势是关系查询效率不够高，关系必须规范化。
关键技术 一条SQL的一生 SQL -> Parser -> optimizer -> Executor
语法解析器Parser 词法分析：获得关键字、表列名、常量、运算符、结束符 语法分析：填充一个数据结构Stmt 语义分析：检查table/name是否存在，变量是否合法 optimizer 基于规则的优化 基于代价的优化 Executor 火山模型 向量化 编译执行 存储引擎 - InnoDB In-Memory
Buffer Pool Change Buffer Adaptive Hash Index Log Buffer On-Disk
System Tablespace General Tablespace Undo Tablespace Temporary Tablespace Redo Log 事务引擎 通过Undo Log实现事务回退。 隔离性通过锁实现 读读 share lock 写写 exclusive lock 读写 share lock | exclusive lock | MVCC读写分离 持久性 事务提交前页面写盘(随机IO、写放大) WAL(write-ahead logging)，通过redo log 记录页面的变化，如果发生错误，重启后根据redo log 重做 企业实践 红包 流量大、流量突增、稳定性"></head><body class=not-ready data-menu=true><header class=header><p class=logo><a class=site-name href=https://magiconline.github.io/>魔法张的Blog</a><a class=btn-dark></a></p><script>let bodyClx=document.body.classList,btnDark=document.querySelector('.btn-dark'),sysDark=window.matchMedia('(prefers-color-scheme: dark)'),darkVal=localStorage.getItem('dark'),setDark=e=>{bodyClx[e?'add':'remove']('dark'),localStorage.setItem('dark',e?'yes':'no')};setDark(darkVal?darkVal==='yes':sysDark.matches),requestAnimationFrame(()=>bodyClx.remove('not-ready')),btnDark.addEventListener('click',()=>setDark(!bodyClx.contains('dark'))),sysDark.addEventListener('change',e=>setDark(e.matches))</script><nav class=menu><a href=/about/>关于</a></nav><nav class=social><a class=github style=--url:url(./github.svg) href=https://github.com/magiconline target=_blank></a></nav></header><main class=main><article class=post-single><header class=post-title><p><time>Jun 4, 2022</time></p><h1>深入理解RDBMS</h1></header><section class=post-content><h1 id=经典案例>经典案例</h1><h2 id=关系型数据库事务acid>关系型数据库事务ACID</h2><ul><li>事务(Transaction): 是由一组SQL语句组成的一个程序执行单元</li><li>ACID： 原子性、一致性、隔离性、持久性</li></ul><h1 id=发展历史>发展历史</h1><h2 id=前dbms时代>前DBMS时代</h2><p>人工管理、文件系统</p><h2 id=dbms数据模型>DBMS数据模型</h2><p>数据库按数据模型的特点可以分成：网状数据库、层次数据库和关系型数据库</p><p>关系型数据库的劣势是关系查询效率不够高，关系必须规范化。</p><h1 id=关键技术>关键技术</h1><h2 id=一条sql的一生>一条SQL的一生</h2><p>SQL -> Parser -> optimizer -> Executor</p><h2 id=语法解析器parser>语法解析器Parser</h2><ul><li>词法分析：获得关键字、表列名、常量、运算符、结束符</li><li>语法分析：填充一个数据结构Stmt</li><li>语义分析：检查table/name是否存在，变量是否合法</li></ul><h2 id=optimizer>optimizer</h2><ul><li>基于规则的优化</li><li>基于代价的优化</li></ul><h2 id=executor>Executor</h2><ul><li>火山模型</li><li>向量化</li><li>编译执行</li></ul><h2 id=存储引擎---innodb>存储引擎 - InnoDB</h2><p>In-Memory</p><ul><li>Buffer Pool</li><li>Change Buffer</li><li>Adaptive Hash Index</li><li>Log Buffer</li></ul><p>On-Disk</p><ul><li>System Tablespace</li><li>General Tablespace</li><li>Undo Tablespace</li><li>Temporary Tablespace</li><li>Redo Log</li></ul><h2 id=事务引擎>事务引擎</h2><ul><li>通过Undo Log实现事务回退。</li><li>隔离性通过锁实现<ul><li>读读 share lock</li><li>写写 exclusive lock</li><li>读写 share lock | exclusive lock | MVCC读写分离</li></ul></li><li>持久性<ol><li>事务提交前页面写盘(随机IO、写放大)</li><li>WAL(write-ahead logging)，通过redo log 记录页面的变化，如果发生错误，重启后根据redo log 重做</li></ol></li></ul><h1 id=企业实践>企业实践</h1><h2 id=红包>红包</h2><p>流量大、流量突增、稳定性</p><h3 id=大流量---sharding>大流量 - sharding</h3><ul><li>业务数据进行水平拆分</li><li>代理层进行分片路由</li></ul><h3 id=流量突增---扩容代理连接池>流量突增 - 扩容、代理连接池</h3><ul><li>扩容DB物理节点数量</li><li>利用影子表进行压测</li></ul><h3 id=稳定性可靠性>稳定性&可靠性</h3><ul><li>多机房</li><li>代理：读写分离、分库分表、限流、流量调控</li></ul></section><nav class=post-nav><a class=next href=https://magiconline.github.io/post/%E5%B8%A6%E4%BD%A0%E8%AE%A4%E8%AF%86%E5%AD%98%E5%82%A8%E6%95%B0%E6%8D%AE%E5%BA%93/><span>带你认识存储数据库</span><span>→</span></a></nav></article></main><footer class=footer><p>&copy; 2022 <a href=https://magiconline.github.io/>魔法张的Blog</a></p><p>Powered by <a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>️</p><p><a href=https://github.com/nanxiaobei/hugo-paper rel=noopener target=_blank>Paper 5.1</a></p></footer></body></html>